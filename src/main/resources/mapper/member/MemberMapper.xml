<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.anonym.module.member.MemberDao">

    <resultMap id="MemberVO" type="com.anonym.module.member.domian.MemberVO"></resultMap>

    <resultMap id="MemberEntity" type="com.anonym.module.member.domian.MemberEntity"></resultMap>

    <select id="queryByPage" resultMap="MemberVO">
        SELECT
        member_id,
        service_item_id,
        phone,
        NAME,
        member_price,
        total_num,
        unused_num,
        create_time,
        update_time
        FROM
        t_member
        <where>
            <if test="queryDTO.startDate != null and queryDTO.startDate != ''">
                AND DATE_FORMAT(create_time, '%Y-%m-%d') &gt;= #{queryDTO.startDate}
            </if>
            <if test="queryDTO.endDate != null and queryDTO.endDate != ''">
                AND DATE_FORMAT(create_time, '%Y-%m-%d') &lt;= #{queryDTO.endDate}
            </if>
            <if test="queryDTO.name != null and queryDTO.name != ''">
                AND INSTR(name,#{queryDTO.name})
            </if>
            <if test="queryDTO.phone != null and queryDTO.phone != ''">
                AND INSTR(phone,#{queryDTO.phone})
            </if>
        </where>
    </select>

    <select id="getByName" resultMap="MemberEntity">
        SELECT
        member_id,
        service_item_id,
        phone,
        NAME,
        member_price,
        total_num,
        unused_num,
        create_time,
        update_time
        FROM
        t_member
        WHERE
        name = #{name}
        <if test="serviceItemId != null">
            AND service_item_id = #{serviceItemId}
        </if>
        <if test="excludeId != null">
            AND member_id != #{excludeId}
        </if>
    </select>


</mapper>